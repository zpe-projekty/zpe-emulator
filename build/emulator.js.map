{"version":3,"file":"emulator.js","mappings":";AAAA;AACA;AACA;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACPA;;;;;;ACEA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack://zpe-emulator/webpack/bootstrap","webpack://zpe-emulator/webpack/runtime/define property getters","webpack://zpe-emulator/webpack/runtime/hasOwnProperty shorthand","webpack://zpe-emulator/./src/emulator.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","\n\n// const entry = {\n//     init: (container: HTMLElement, api: any, options: any) => Promise.resolve(),\n//     getState: () => ({}),\n//     setState: (state: any) => { }\n// }\n\nexport function define(fn: () => any) {\n\n    const entry = fn().default();\n    const container = document.getElementById(\"emulator-container\") as HTMLElement;\n    const api = {\n        enginePath: (path: string) => path,\n\n        triggerStateSave: async (): Promise<void> => {\n            return new Promise((resolve) => {\n                console.log(\"State save triggered\");\n                setTimeout(() => {\n                    const state = entry.getState()\n                    console.log(\"Saved state:\", state);\n                    resolve();\n                }, 200);\n            });\n        },\n        triggerStateRestore: async (): Promise<void> => {\n            return new Promise((resolve) => {\n                console.log(\"State restore triggered\");\n                callSetState(null).then(() => {\n                    resolve();\n                });\n            });\n        }\n    } as any;\n    const options = {} as any;\n\n    function callSetState(state: any): Promise<void> {\n        return new Promise((resolve) => {\n            setTimeout(() => {\n                entry.setState(state);\n                resolve();\n            }, 200);\n        });\n    }\n\n    fetch(\"engine.json\").then(response => response.json()).then(async (engineManifest) => {\n        console.log(engineManifest);\n        options.data = engineManifest?.editor?.defaultData || {};\n    }).then(() => {\n        entry.init(container, api, options).then(() => {\n            console.log(\"Engine initialized\");\n            // const lastState = localStorage.getItem(\"emulator-last-state\");\n\n            return fetch(\"savedata.json\").then(response => {\n                response.text().then(text => {\n                    const lastState = (text.trim().startsWith(\"null\") || text.trim().startsWith(\"undefined\") || text.trim() === \"\") ? undefined : JSON.parse(text);\n\n                    callSetState(lastState).then(() => {\n                        console.log(\"Engine running\");\n                    });\n                });\n            });\n        });\n    });\n}\n"],"names":[],"sourceRoot":""}